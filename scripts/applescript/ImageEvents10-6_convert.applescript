-- Image Events (v10.6)-- image-- bmp,jpg,jpeg,pict,png,tif,tiff,gif,pdf,sgi,tga,mac,qif
-- bmp,jpg,jpeg,pict,png,tiff,tif,qif-- pass the arguments on run argumentset importPath to (item 1 of argument)set exportPath to (item 2 of argument)-- debug-- set importPath to "Users/user/Documents/scripts/image.tif" 
-- set exportPath to "Users/user/Documents/scripts/image.jpg"-- display dialog "Import path: " & (importPath) 
-- end of debug-- split the export pathset text item delimiters to "/"set theList to text items of exportPathset numItems to count theList-- parse the last item - new nameset newName to item numItems of theList-- split the name and parse the extensionset text item delimiters to "."set theList to text items of newNameset numItems to count theList-- parse the last item - extensionset newFormat to item numItems of theList-- display dialog "Extension: " & newFormat-- run the application tell application "Image Events"tell application "Image Events"	-- start the Image Events application	launch	-- open the image file	set theImage to open importPath	-- set the supported formats in	if (newFormat is "tif") or (newFormat is "tiff") then		set the newFormat to TIFF	else if newFormat is "bmp" then		set the newFormat to BMP	else if (newFormat is "jpg") or (newFormat is "jpeg") then		set the newFormat to JPEG	else if (newFormat is "jpg2") or (newFormat is "jpeg2") then		set the newFormat to JPEG2	else if newFormat is "pict" then		set the newFormat to PICT	else if newFormat is "png" then		set the newFormat to PNG	else if newFormat is "psd" then		set the newFormat to PSD	else if (newFormat is "qtif") or (newFormat is "qti") or (newFormat is "qif") then		set the newFormat to QuickTime Image	else		close theImage		quit	end if
	-- save in new file. The result is a file ref to the new file.	set the new_image to save theImage as newFormat in file exportPath with icon	-- purge the open image data	close theImageend tellend run